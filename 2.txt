steps: 
- task: HelmDeploy@0
  displayName: helm upgrade
  inputs:
    connectionType: Azure Resource Manager
    azureSubscription: MemberApp Non Prod Environment
    azureResourceGroup: $(azureResourceGroup)
    kubernetesCluster: $(kubernetesCluster)
    useClusterAdmin: true
    namespace: myntuc-agent
    command: upgrade
    chartType: FilePath
    chartPath: helm
    releaseName: $(releaseName)
    overrideValues: |
      env.API_KEY=$(myntuc-agent-api-key)
      env.LOYALTY_BRIDGE_API_AUDIENCE=$(myntuc-agent-loyalty-bridge-api-audience)
      env.LOYALTY_BRIDGE_API_BASE_URL=$(myntuc-agent-loyalty-bridge-api-base-url)
      env.LOYALTY_TECH_API_AUDIENCE=$(myntuc-agent-loyalty-tech-api-audience)
      env.LOYALTY_TECH_API_BASE_URL=$(myntuc-agent-loyalty-tech-api-base-url)
      env.LOYALTY_TECH_API_CLIENT_ID=$(myntuc-agent-loyalty-tech-api-client-id)
      env.LOYALTY_TECH_API_CLIENT_SECRET=$(myntuc-agent-loyalty-tech-api-client-secret)
      env.LOYALTY_TECH_API_GRANT_TYPE=$(myntuc-agent-loyalty-tech-api-grant-type)
      env.LOYALTY_TECH_AUTH_API_BASE_URL=$(myntuc-agent-loyalty-tech-auth-api-base-url)
      env.NEXT_PUBLIC_AZURE_AD_CLIENT_ID=$(myntuc-agent-next-public-azure-ad-client-id)
      env.NEXT_PUBLIC_AZURE_AD_CLIENT_SECRET=$(myntuc-agent-next-public-azure-ad-client-secret)
      env.NEXT_PUBLIC_AZURE_AD_TENANT_ID=$(myntuc-agent-next-public-azure-ad-tenant-id)
      env.UCEM_API_PASSWORD=$(myntuc-agent-ucem-api-password)
      env.UCEM_API_USERNAME=$(myntuc-agent-ucem-api-username)
      env.UCEM_BASE_URL=$(myntuc-agent-ucem-base-url)
      env.UCEM_X_API_KEY=$(myntuc-agent-ucem-x-api-key)
      ingress.enabled=true
      ingress.hosts.host=$(url)
      ingress.tls.hosts=$(url)
      image.repository=$(dockerRegistryServiceConnection).azurecr.io/$(imageName)
      image.pullPolicy=Always
      image.tag=$(Build.SourceVersion)
    recreate: false